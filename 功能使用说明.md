# ACGStation 游戏文件同步器 - 功能使用说明

## 🎮 新增功能概述

### 压缩包更新功能
为了减少服务器请求压力和提高下载效率，新增了"压缩包更新"功能。当文件夹被标记为"更新包"时，会被特殊处理以优化服务器性能。

## 🚀 主要功能

### 1. 文件浏览和选择
- **选择文件夹**: 点击"选择文件夹"按钮，选择要导出的根目录
- **预览内容**: 自动显示文件夹中的所有文件和子文件夹
- **多选支持**: 使用复选框选择要导出的文件和文件夹

### 2. 压缩选项
对于文件夹，可以选择以下选项：

#### 📁 不压缩
- 文件夹内容直接添加到导出包
- 保持原有目录结构
- 适用于配置文件、脚本等小文件

#### 🗜️ 压缩
- 将文件夹压缩为ZIP文件
- 减少导出包大小
- 适用于资源文件、备份等

#### 📦 压缩包更新（新功能）
- **用途**: 减少服务器请求压力
- **特点**: 被标记为特殊的更新包类型
- **处理**: 在同步时自动解压
- **适用场景**: 
  - 大型资源包（纹理、音频、模型）
  - 游戏模组包
  - 频繁更新的内容

## 🎯 使用流程

### 步骤1: 选择文件
1. 点击"选择文件夹"按钮
2. 浏览并选择要导出的游戏目录
3. 等待文件列表加载完成

### 步骤2: 配置选项
1. **选择文件**: 勾选要导出的文件和文件夹
2. **设置压缩**: 对于文件夹，选择是否压缩
3. **更新包设置**: 对于压缩的文件夹，选择是否作为更新包

#### 压缩包更新的使用场景
```
✅ 推荐使用更新包的情况:
- 游戏资源文件夹 (assets/, textures/, sounds/)
- 模组包 (mods/, plugins/)
- 地图包 (maps/, levels/)
- 大型数据文件夹 (data/, content/)

❌ 不建议使用更新包的情况:
- 配置文件 (config.ini, settings.json)
- 单个小文件
- 用户自定义文件
- 临时文件
```

### 步骤3: 导出配置
1. **包名**: 设置导出包的名称
2. **下载前缀**: 设置CDN或服务器的下载URL前缀
3. **版本**: 设置包版本号

### 步骤4: 执行导出
1. 点击"导出选中的 X 个项目"按钮
2. 等待处理完成
3. 文件将保存到桌面，格式为 `{包名}.zip`

## 📋 导出结果详解

### 生成文件
导出完成后会生成一个ZIP文件，包含：

1. **manifest.json** - 导出清单文件
2. **实际文件** - 根据选择的压缩选项处理

### 清单文件示例
```json
{
  "packageName": "GameUpdate",
  "version": "1.0.0",
  "createdAt": "2024-01-01T00:00:00Z",
  "files": [
    {
      "name": "config.ini",
      "downloadUrl": "https://cdn.example.com/downloads/config.ini",
      "relativePath": "config.ini",
      "hash": "abc123...",
      "size": 1024,
      "type": "file",
      "autoExtract": null
    },
    {
      "name": "assets.zip",
      "downloadUrl": "https://cdn.example.com/downloads/assets.zip",
      "relativePath": "assets.zip",
      "hash": "def456...",
      "size": 10485760,
      "type": "update_package",
      "autoExtract": true
    }
  ]
}
```

### 文件类型说明
- **type: "file"** - 普通文件，直接使用
- **type: "zip"** - 常规压缩包，可选择解压
- **type: "update_package"** - 更新包，自动解压

## ⚡ 性能优化建议

### 1. 合理使用更新包功能
```
大型文件夹 (>100MB) → 建议使用更新包
中型文件夹 (10-100MB) → 可选使用更新包
小型文件夹 (<10MB) → 建议直接压缩或不压缩
```

### 2. 服务器部署优化
- 将更新包部署到CDN
- 启用HTTP/2和压缩
- 配置适当的缓存策略
- 支持断点续传

### 3. 带宽优化
- 更新包减少HTTP请求数量
- 批量下载提高效率
- 自动解压减少客户端处理

## 🔧 故障排除

### 常见问题

#### 1. 导出失败
**可能原因**:
- 磁盘空间不足
- 文件权限问题
- 包名包含特殊字符

**解决方案**:
- 检查磁盘空间
- 以管理员身份运行
- 使用简单的包名

#### 2. 文件过大
**现象**: 导出的ZIP文件非常大

**解决方案**:
- 选择性导出文件
- 增加压缩包更新的使用
- 排除不必要的文件

#### 3. 加载缓慢
**现象**: 文件列表加载很慢

**解决方案**:
- 避免选择包含大量文件的根目录
- 分批次导出
- 关闭杀毒软件的实时扫描

## 📊 最佳实践

### 1. 项目结构建议
```
游戏项目/
├── config/          # 配置文件 → 不压缩
├── assets/          # 资源文件 → 压缩 + 更新包
├── mods/            # 模组文件 → 压缩 + 更新包
├── saves/           # 存档文件 → 压缩（非更新包）
└── logs/            # 日志文件 → 不导出
```

### 2. 版本管理
- 使用语义化版本号 (1.0.0)
- 主版本号变更时更新包名
- 定期清理旧版本

### 3. 团队协作
- 统一包名规范
- 文档化导出流程
- 建立版本发布流程

## 🔮 未来功能

### 计划中的功能
- [ ] 差异化更新检测
- [ ] 增量导出支持
- [ ] 自动化导出脚本
- [ ] 导出模板功能
- [ ] 批量导出支持

### 下载同步功能（下一步开发）
- 基于manifest.json的差异检测
- 智能下载调度
- 断点续传支持
- 进度显示和状态管理

---

**提示**: 如有问题或建议，请参考《导出包整合规范.md》了解技术细节。
